var _=e=>{var t;let r=e?e.match(/([0-9a-zA-Z\-]*)?(#[0-9a-zA-Z\-]*)?((.[0-9a-zA-Z\-]+)*)/):void 0,s=r?(t=r.slice(1,4))===null||t===void 0?void 0:t.map(n=>n?n.trim():void 0):Array(3).fill(void 0);return s&&s[1]&&(s[1]=s[1].replace(/#*/g,"")),r?{tag:s[0]||void 0,id:s[1]||void 0,classes:s[2]?s[2].split(".").filter(n=>n.trim()):void 0}:{}},p=(e,t={})=>{let{contents:r,c:s,misc:n,m:a,style:c,s:u,on:l,attrs:d,a:o,raw:h}=t;return r=r||s||"",r=h?r:g(r),e.innerHTML=r,Object.assign(e,n||a),Object.assign(e.style,c||u),Object.entries(l||{}).forEach(([v,b])=>e.addEventListener(v,b)),Object.entries(d||o||{}).forEach(([v,b])=>e.setAttribute(v,b)),e},y=(e,t={})=>{let{tag:r,id:s,classes:n}=_(e);r||(r="div");let a=document.createElement(r);return s&&(a.id=s),(n||[]).forEach(c=>a.classList.add(c)),p(a,t)},k=(e,t)=>{if(Object.keys(t).length!==1)throw new Error("Too many or too few positions specified.");let s=Object.values(t)[0],n="afterend";return t.after?n="afterend":t.before?n="beforebegin":t.atStartOf?n="afterbegin":t.atEndOf&&(n="beforeend"),s.insertAdjacentElement(n,e),e},m=class{constructor(e){this.value=null,this._subscribers={},this._subscriberCounts={},this._dead=!1,this.value=e}on(e,t,r=!1){return this._subscriberCounts[e]=this._subscriberCounts[e]||0,this._subscribers[e]=this._subscribers[e]||{},this._subscribers[e][this._subscriberCounts[e]]=t,r&&!["push","remove","mutation","setAt"].includes(e)&&t(this.value),this._subscriberCounts[e]++}unsubscribe(e,t){delete this._subscribers[e][t]}update(e){this._dead||(this.value=e,this._sendEvent("update",e))}refresh(){this._sendEvent("refresh",this.value)}_sendEvent(e,t){if(!this._dead){this._subscribers[e]=this._subscribers[e]||{};for(let r in Object.keys(this._subscribers[e]))this._subscribers[e][r](t)}}dispose(){this._dead=!0,this._subscribers={},this._subscriberCounts={}}},O=class extends m{constructor(e){super(e)}clear(){this.update([])}push(e){this.value.push(e),this._sendEvent("push",{value:e,idx:this.value.length-1})}remove(e){if(e<0||e>=this.value.length)throw new RangeError("Invalid index.");this._sendEvent("remove",{value:this.value.splice(e,1)[0],idx:e})}get(e){if(e<0||e>this.value.length)throw new RangeError("Invalid index.");return this.value instanceof Array&&this.value[e]}setAt(e,t){if(e<0||e>=this.value.length)throw new RangeError("Invalid index.");this.value[e]=t,this._sendEvent("mutation",{value:t,idx:e})}get length(){return this.value.length}},j=(e,t={})=>{let r=new RegExp("\\\\({{\\s*"+Object.keys(t).join("|")+"\\s*}})","gi");return new RegExp(Object.keys(t).join("|"),"gi"),e.replace(new RegExp("(^|[^\\\\]){{\\s*("+Object.keys(t).join("|")+")\\s*}}","gi"),function(s,n,a){return`${n||""}${t[a]}`}).replace(r,"$1")},E=(e,t={},r=!0)=>{let s=Object.assign({},t);return r&&(s=Object.fromEntries(Object.entries(s).map(([n,a])=>[n,g(a)]))),j(e,s)},w=(e,t)=>r=>E(e,r,t),g=e=>e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):"",T=e=>{if(!e)return"";let t=/&(?:amp|lt|gt|quot|#(0+)?39);/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};return e.replace(t,s=>r[s]||"'")},i={Store:m,ListStore:O,nu:y,mustache:E,template:w,escape:g,unescape:T,extend:p,insert:k};var C={display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,0.6)",width:"100vw",height:"100vh",padding:0,margin:0,position:"fixed",top:0,left:0},f=()=>{var n;(n=document.querySelector("#alert-mask"))==null||n.remove();let e=i.insert(i.nu("div#alert-mask",{style:C,raw:!0,c:`<div id='cf-alert'>
        <div id='alert-header'></div>
        <div id='alert-body'></div>
        <div id='alert-footer'></div>
        </div>
        `}),{atEndOf:document.body}),t=e.querySelector("#alert-header"),r=e.querySelector("#alert-body"),s=e.querySelector("#alert-footer");return[t,r,s,e]};function H(e,t="Error",r=!0){let[s,n]=f();return new Promise(()=>{s.innerHTML=i.escape(t),n.innerHTML=r?i.escape(e):e})}function M(e,t="Info",r="OK",s=!0){let[n,a,c,u]=f();return new Promise((l,d)=>{try{n.innerHTML=i.escape(t),a.innerHTML=s?i.escape(e):e,i.insert(i.nu("button#alert-ok",{on:{click:o=>{l(),u.remove()}},c:r}),{atEndOf:c})}catch(o){d(o)}})}function A(e,t,r="Input",s=!0){let[n,a,c,u]=f();return new Promise((l,d)=>{try{n.innerHTML=i.escape(r),a.innerHTML=s?i.escape(t):t;let o=i.insert(i.nu(`${e==="textarea"?"textarea":"input"}#alert-input`,{attrs:{type:e}}),{atEndOf:a});i.insert(i.nu("button#alert-cancel",{on:{click:h=>{d("Cancelled by user"),u.remove()}},c:"Cancel"}),{atEndOf:c}),i.insert(i.nu("button#alert-ok",{on:{click:h=>{l(o.value),u.remove()}},c:"Submit"}),{atEndOf:c})}catch(o){d(o)}})}function S(e,t,r="Are you sure?",s=!0){let[n,a,c,u]=f();return new Promise((l,d)=>{try{n.innerHTML=i.escape(r),a.innerHTML=s?i.escape(e):e,i.insert(i.nu("button#alert-cancel",{on:{click:o=>{l(!1),u.remove()}},c:(t==null?void 0:t.no)||"No"}),{atEndOf:c}),i.insert(i.nu("button#alert-ok",{on:{click:o=>{l(!0),u.remove()}},c:(t==null?void 0:t.yes)||"Yes"}),{atEndOf:c})}catch(o){d(o)}})}var I={input:A,message:M,confirm:S,fatal:H};export{S as confirm,I as default,H as fatal,A as input,M as message};
